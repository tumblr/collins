---
layout: default
title: Infrastructure Management for Engineers
desc: Collins - Infrastructure Management for Engineers
permalink: index.html
---

<header class="jumbotron subhead" id="overview">
  <div class="container">
    <h1>
      Collins
    </h1>
    <p class="lead">Infrastructure management for engineers</p>
  </div>
</header>

<div class="container">

  <div class="row">
    <div class="span3 sidebar">
      <ul class="nav nav-list sidenav">
        <li><a href="#about"><i class="icon-chevron-right"></i> About</a></li>
        <li><a href="#features"><i class="icon-chevron-right"></i> Features</a></li>
        <li><a href="#design"><i class="icon-chevron-right"></i> Design</a></li>
        <li><a href="#motivations"><i class="icon-chevron-right"></i> Motivations</a></li>
        <li><a href="#quickstart"><i class="icon-chevron-right"></i> Quickstart</a></li>
        <li><a href="#links"><i class="icon-chevron-right"></i> Links</a></li>
        <li><a href="#thanks"><i class="icon-chevron-right"></i> Thanks</a></li>
      </ul>
    </div>

    <div class="span9">
      <section id="about">
        <div class="page-header">
          <h1>About</h1>
        </div>
        <p class="lead">
          Collins exists to drive infrastructure automation.
        </p>
        <p>
          Someone recently asked me to describe collins in a sentence. At Tumblr, it's the infrastructure
          source of truth and knowledge. Everything about Tumblr production environments is stored and
          encoded in Collins, and that data is used to drive all of our automation. Sometimes people refer
          to systems like this as a CMDB, or Configuration Management DataBase.
        </p>
	      <p>
	        Collins started as a system to manage all of the physical servers, switches,
	        racks, etc in Tumblr production environments. As we started to
	        inventory hardware, IP addresses, software, and so on, we found the API and
	        data gave us an excellent way to drive automation processes. Today Collins can
	        do push button cluster (HBase, Hadoop, web, etc) deployment, drive configuration
	        generation when hardware cluster topologies change, drive infrastructure updates
	        when software configuration changes, and help manage software deploys.
	      </p>
        <p>
          Because of the loosely coupled design of Collins, consistently applied
	        conventions are a system requirement. This document serves as a guide
	        to those conventions as well as the basic core concepts of the collins system.
	        If you're just interested in the basic howto or screenshots, click
	        <a href="overview.html">here</a>.
        </p>
      </section> <!-- about -->

      <section id="features">
        <div class="page-header">
          <h1>Features</h1>
        </div>
        <p class="lead">
          Collins consists of the core application, a set of client libraries, the collins-shell,
          and an automation toolchain. Nothing but collins core is required.
        </p>
	      <ul>
	        <li>Documented, consistent REST API</li>
	        <li>Client API libraries in Ruby, Python and Bash</li>
	        <li>A collins command line shell for scripting and automation</li>
	        <li>A callback system for hooking into asset lifecycle events</li>
	        <li>Multiple authentication backends (LDAP, files, etc)</li>
	        <li>Per-feature and per-endpoint configurable permissions</li>
	        <li>Flexible Web and API based provisioning (PXE, SSH/grub/kickstart, API (e.g. AWS))</li>
	        <li>Power management support</li>
	        <li>IP Address allocation and management support</li>
	        <li>Support for running collins in distributed mode across multiple datacenters</li>
          <li>Flexible data-model supporting multi-dimensional keys/values per asset</li>
          <li>Simple key/value queries as well as a more advanced query language</li>
          <li>A script engine for modifying collins behavior</li>
          <li>Internationalized language support</li>
	      </ul>
      </section>

      <section id="design">
        <div class="page-header">
          <h1>Design</h1>
        </div>
        <p class="lead">
          Collins provides an easy to use API on top of a simple data model. You can extend
          collins through callbacks, plugins, and light-weight collins scripts.
        </p>
	      <p>
          Collins is extremely dumb. It knows about assets, their
	        meta-data and asset logs. You can think of collins as a key/value
	        store where each asset has its own set of key/value pairs. There are
	        no relationships between assets other than the ones you, through
	        convention, derive. The API makes it trivial to create and manage
	        the tags (meta-data, key/value pairs) associated with an asset, and
	        to query based on those tags.
	      </p>
	      <p>
          Collins is intentionally dumb. It worries about basic
	        authentication, clean API interactions, and data persistence. If you
	        start thinking, "Hey, I should build X into Collins", you probably
	        shouldn't. Collins supports both a plugins architecture (for things
	        that actually in some way change the behavior of collins) as well as
	        a very usable API (including clients in Python, Ruby and Bash).
	        Nearly everything you might want to do can be accomplished via the
	        API and anything that can't is doable as a plugin.
	      </p>
      </section>

      <section id="motivations">
        <div class="page-header">
          <h1>Motivations</h1>
        </div>
        <p class="lead">
          By infrastructure engineers, for infrastructure engineers.
        </p>
        <p>
          We looked at a dozen or so open source and commercial products before coding began.
	        Having an API and flexible workflow were requirements. The intake support for our
	        specific hardware intake process also needed to be accounted for. We also needed
	        something that would support not just virtualized systems, but was more tailored
	        towards physical hardware. We found nothing that met the requirements we had.
	        Things we looked at included:
	      </p>
	      <ul>
	        <li><a href="http://openstack.org/">openstack</a></li>
	        <li><a href="https://wiki.ubuntu.com/ServerTeam/Orchestra">Ubuntu Orchestra</a></li>
	        <li><a href="https://forms.raritan.com/products/data-center-infrastructure-management/dctrack/">dcTrack</a></li>
	        <li><a href="http://iptrack.sourceforge.net/">IPplan</a></li>
	        <li><a href="http://opennetadmin.com/">OpenNetAdmin</a></li>
	        <li><a href="http://code.google.com/p/openipam/">openIPAM</a></li>
	        <li><a href="http://code.google.com/p/spoiled/">Spoled</a></li>
	      </ul>
	      <p>
	        Some of these are strictly for IPAM, some handled parts of what collins does. None of these were good fits for the
	        initial problems we were trying to solve.
	      </p>
        <p>
          Collins can sit on top of existing asset management systems (we have done this at Tumblr with both SoftLayer and Amazon)
          or be the infrastructure source of truth for your entire environment. I personally found openstack to be the closest fit for
          what we were looking for but the number of changes required to make it work for Tumblr were substantial.
        </p>
      </section>

      <section id="quickstart">
        <div class="page-header">
          <h1>Quickstart</h1>
        </div>
        <p class="lead">
          Up and running in 5 minutes.
        </p>

        <h3>Software Requirements</h3>
        <p>
          Collins has 1 software requirement, Java 1.6 (with the <a href="http://www.oracle.com/technetwork/java/javase/downloads/jce-6-download-429243.html">unlimited strength JCE</a>).
          Collins is developed using Java 1.6 and in the tests I did with Java 1.7 on OS X collins performed poorly. Typing <code>java -version</code>
          should display something like <code class="inlinecode">java version &quot;1.6.0_35&quot;</code><br>
          If you would like your data to persist between restarts, you should also have MySQL 5.5 (5.1 may work but is untested).
        </p>

        <h3 id="quickstart-prod">Ultra Quick</h3>
        <ol>
          <li>Download the latest collins zip from <a href="downloads.html">here</a></li>
          <li>Unpack the zip file</li>
          <li>run <code>scripts/setup</code> and follow the instructions</li>
        </ol>
        <p>
          Note that the above method will only work with MySQL. If you don't have MySQL available you can follow the instructions
          below which will use an in memory database.
        </p>

        <h3>Software Setup</h3>
        <ol>
          <li>Download the <a href="http://download.playframework.org/releases/play-2.0.3.zip">Play Framework</a></li>
          <li>Unpack the zip into <code>$HOME/src/play-2.0.3</code></li>
          <li><code>cd ~/src/ &amp; &amp; git clone git@github.com:tumblr/collins.git</code></li>
          <li>In <code>~/src/collins</code> type <code>~/src/play-2.0.3/play</code> and hit enter (this will take a minute the first time)</li>
          <li>Once you are in the console type <code>compile</code> and hit enter, you should see no errors. We're just testing your environment, you normally won't do this.</li>
          <li>Type <code>run</code> and then visit <code>http://localhost:9000</code> in your browser. To run with a different configuration file (the default is <code>conf/application.conf</code>), instead of typing run type <code>run -Dconfig.file=/path/to/alt.conf</code>. Login with username <code>blake</code> and password <code>admin:first</code>.</li>
        </ol>
        <p>
          There is a quickstart screencast up <a target="_blank" href="http://www.youtube.com/watch?v=rEyoS-iofK8">here</a>. This has changed slightly since
          it was published, but essentially just walks you through the above an additionally installs and sets up the collins-shell.
        </p>

        <h3>Support Scripts</h3>
        <p>
          There is a supplied population script at <code>scripts/populate.sh</code> which will create 10 assets in your local collins instance for you to play around with.<br>
          There is a supplied package script at <code>scripts/package.sh</code> which will produce a fat zip with all the requirements and dependencies. This is what we deploy to production at Tumblr.<br>
          There is a supplied init script at <code>scripts/collins.sh</code>. This is a useful starting point for running the app and is what we use to run the app in production at Tumblr. This script is also bundled by the <code>scripts/package.sh</code> script. Note that the supplied init script requires <a href="http://libslack.org/daemon/">daemon</a>.
        </p>

        <h3>Authentication</h3>
        <p>
          By default the authentication is provided via the
          <a href="https://github.com/tumblr/collins/blob/master/app/util/security/MockAuthenticationProvider.scala">MockAuthenticationProvider</a>
          (set in <code>conf/application.conf</code> as <code>authentication.type=default</code>). Usernames/passwords for this provider are below.
        </p>
        <p>
          You can change the auth provider by setting <code>authentication.type</code> to <code>file</code> or <code>ldap</code> in
          <code>conf/application.conf</code>. If you set <code>authentication.type</code> to <code>file</code>, the default file used
          is <code>conf/users.conf</code> (which can be changed by setting <code>authentication.file.userfile=/path/to/users.conf</code>).
          The usernames/passwords/groups in the default <code>users.conf</code> file are below.
        </p>
<div class="accordion" id="credentials">
  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#credentials" href="#credentials-default">Default Devel Credentials</a>
    </div>
    <div id="credentials-default" class="accordion-body collapse">
      <div class="accordion-inner">
        <table class="table table-condensed table-hover">
          <thead>
            <tr>
              <th>Username</th><th>Password</th><th>Groups</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>blake</td>
              <td>admin:first</td>
              <td>engineering,infra,ops</td>
            </tr>
            <tr>
              <td>matt</td>
              <td>foobar</td>
              <td>engineering,management</td>
            </tr>
            <tr>
              <td>test</td>
              <td>fizz</td>
              <td>none</td>
            </tr>
            <tr>
              <td>joeengineer</td>
              <td>flah</td>
              <td>engineering</td>
            </tr>
          </tbody>
        </table>
      </div> <!-- accordion inner -->
    </div> <!-- accordion-body -->
  </div> <!-- accordion-group -->
  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#credentials" href="#credentials-file">Default File Credentials</a>
    </div>
    <div id="credentials-file" class="accordion-body collapse">
      <div class="accordion-inner">
        <table class="table table-condensed table-hover">
          <thead>
            <tr>
              <th>Username</th><th>Password</th><th>Groups</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>blake</td>
              <td>8vCeb3h8F863</td>
              <td>engineering,infra,ops</td>
            </tr>
            <tr>
              <td>matt</td>
              <td>0592607689Cr</td>
              <td>engineering,management</td>
            </tr>
            <tr>
              <td>test</td>
              <td>h2624A7WJA3y</td>
              <td>none</td>
            </tr>
            <tr>
              <td>joeengineer</td>
              <td>4ZRl5311al77</td>
              <td>engineering</td>
            </tr>
          </tbody>
        </table>
      </div> <!-- accordion inner -->
    </div> <!-- accordion-body -->
  </div> <!-- accordion-group -->
</div> <!-- accordion -->
        <p>
          The script used to generate the file based passwords is available at <code>scripts/gen_passwords.sh</code>
        </p>
        <p>
          There is more complete authentication configuration documentation available <a href="configuration.html#auth">here</a>
        </p>
      </section>

      <section id="links">
        <div class="page-header">
          <h1>Links</h1>
        </div>
        <p class="lead">
          Quick links to useful resources
        </p>
        <ul>
          <li><a target="_blank" href="https://github.com/tumblr/collins/issues?state=open">Submit issues</a></li>
          <li><a target="_blank" href="https://groups.google.com/forum/#!forum/collins-sm">Find help</a></li>
          <li>Hang out at <span style="font-family: monospace;">#collins</span> on <a target="_blank" href="http://freenode.net/">freenode</a></li>
          <li><a target="_blank" href="https://github.com/tumblr/collins">Code</a></li>
          <li><a target="_blank" href="downloads.html">Downloads</a></li>
          <li><a target="_blank" href="http://tumblr.github.com/collins">Docs</a></li>
	      </ul>
      </section>

      <section id="thanks">
        <div class="page-header">
          <h1>Thanks</h1>
        </div>
        <p>
          A number of people were responsible for Collins growing into the useful tool that it has.
        </p>
        <ul>
          <li>Dan Simon for being the only other collins contributor for months</li>
          <li>Steve Salevan for jumping in at the last minute to help get collins into shape to open-source</li>
          <li>Joshua Hoffman for working with me on the initial specs</li>
          <li>Dallas Marlow for figuring out all the ways to use the API that I didn't anticipate</li>
          <li>Brad McDuffie for providing feedback on collins-shell (and making it usable)</li>
          <li>Everyone else who helped with testing or provided feedback</li>
        </ul>
      </section>

    </div> <!-- span9 -->
  </div> <!-- row -->
</div> <!-- container -->
