# This is the main configuration file for the application.
# THIS IS NOT A PRODUCTION CONFIGURATION - DEVELOPMENT ONLY
# ~~~~~

# Secret key
# ~~~~~
# The secret key is used to secure cryptographics functions.
# If you deploy your application to several instances be sure to use the same key!
application.secret="C0QLExeoJh0WT7`AoMU@owb6dQlV=JJqGG8nh5kWqP3M31`RdFDcJnipv0AQbI>@"
parsers.text.maxLength=1048576
#evolutionplugin=disabled

# Do not change the crypto key after you have started using it, you will be unable to decrypt data
crypto.key="D~567q23=)3s4k3/P#r6XcvYIY447&{jd3%#bd{d-o'_R4X5g.Po36:8tXHX@Gz"

# Application features to enable or disable
features.intakeSupported=true
features.sloppyStatus=true
features.encryptedTags="SYSTEM_PASSWORD,LOCATION"
#features.ignoreDangerousCommands="sl-102313"
#features.allowTagUpdates="RACK_POSITION"
#features.deleteMetaOnDecommission=false
#features.deleteSomeMetaOnRepurpose="CONFIG_SHA, TUMBLR_SHA, NODECLASS"
#features.hideMeta="RACK_POSITION, POWER_PORT, DISK_STORAGE_TOTAL"
features.noLogPurges="SYSTEM_PASSWORD"

multicollins.enabled=true
multicollins.instanceAssetType = "DATA_CENTER"  # defaults to Data Center
multicollins.locationAttribute = "LOCATION" # value looks like protocol://ip-address[:port];user:password
multicollins.thisInstance = "localhost" #the tag of the data center that represents this instance

nodeclass.assetType = "CONFIGURATION"
nodeclass.identifyingMetaTag = "IS_NODECLASS"
nodeclass.excludeMetaTags = "IS_NODECLASS,NOTE"
nodeclass.sortKeys = "SL_RACK_POSITION,SL_RACK" #ordered from least significant to most

powerconfiguration.unitsRequired=2
powerconfiguration.unitComponents="PORT,OUTLET"
powerconfiguration.uniqueComponents="PORT"
powerconfiguration.useAlphabeticNames=true

# Callback Plugin
callbacks.enabled=true
callbacks.callback.nowProvisioned.event="asset_update"
callbacks.callback.nowProvisioned.previous.matchMethod="isProvisioning"
callbacks.callback.nowProvisioned.current.matchMethod="isProvisioned"
callbacks.callback.nowProvisioned.matchMethod="tag"
callbacks.callback.nowProvisioned.matchAction="exec /Users/bmatheny/src/platform/collins/clients/apps/notifier/bin/notifier --config=/Users/bmatheny/src/platform/collins/clients/apps/notifier/notifier.yaml --tag=<tag> --logfile=/tmp/notifier.log --debug --template=provisioned_email.html.erb"

# SoftLayer Plugin
softlayer.enabled=true
softlayer.username="c37452davi"
softlayer.password="92a7e4c9169d737b34138a56ccc4ded66a04c172945b0292b0158c5c9f429e6b"
softlayer.allowedCancelStatus="Unallocated, Allocated, Maintenance"

listtags.all.order="~tag,HOSTNAME,PRIMARY_ROLE,~getStatusName,~created,~updated,SL_LINK"
listtags.all.default="<em>Undefined</em>"

listtags.~created.header="Created"
listtags.~created.formatter="dateFormat"
listtags.~getStatusName.formatter="ellipsis"
listtags.~getStatusName.header="Status"
listtags.~tag.decorator="<a href=\"~{util.views.ListHelper.getAssetURL}\">{value}</a>"
listtags.~tag.header="Asset Tag"
listtags.~updated.header="Last Updated"
listtags.~updated.default="<em>Never</em>"
listtags.~updated.formatter="dateFormat"

listtags.HOSTNAME.default="<em>None</em>"
listtags.HOSTNAME.formatter="ellipsis"
listtags.HOSTNAME.showif="showHostname"
listtags.PRIMARY_ROLE.default="<em>Unknown</em>"
listtags.SL_LINK.default="<em>None</em>"
listtags.SL_LINK.decorator="~{util.views.ListHelper.renderSoftLayerLink}"
listtags.SL_LINK.header="SL Link"
listtags.SL_LINK.showIf="showSoftLayerLink"

tagdecorators.GRAPHS.decorator="<img src=\"{value}\">"
tagdecorators.GRAPHS.valueParser="util.views.DelimiterParser"
tagdecorators.GRAPHS.delimiter=";"
tagdecorators.GRAPHS.between="<br>"
tagdecorators.STATS_LINKS.decorator="<a target=\"_blank\" href=\"{value}\">{i.label}</a>"
tagdecorators.STATS_LINKS.valueParser="util.views.DelimiterParser"
tagdecorators.STATS_LINKS.delimiter=" "
tagdecorators.STATS_LINKS.between=" - "
tagdecorators.STATS_LINKS.0.label="Thrift"
tagdecorators.STATS_LINKS.1.label="HTTP"
tagdecorators.TUMBLR_SHA.decorator="<a target=\"_blank\" href=\"https://github.com/tumblr/tumblr/commit/{value}\">{value}</a>"
tagdecorators.CONFIG_SHA.decorator="<a target=\"_blank\" href=\"https://github.com/tumblr/config/commit/{value}\">{value}</a>"
tagdecorators.PRIMARY_ROLE.decorator="<a href=\"/resources?attribute={name}%3B{value}\">{value}</a>"
tagdecorators.SECONDARY_ROLE.decorator="<a href=\"/resources?attribute={name}%3B{value}\">{value}</a>"
tagdecorators.POOL.decorator="<a href=\"/resources?attribute={name}%3B{value}\">{value}</a>"
tagdecorators.POWER_PORT.decorator="<a href=\"/resources?attribute={name}%3B{value}\">{value}</a>"
tagdecorators.SL_ROOM.decorator="<a href=\"/resources?attribute={name}%3B{value}\">{value}</a>"
tagdecorators.SL_RACK.decorator="<a href=\"/resources?attribute={name}%3B{value}\">{value}</a>"
tagdecorators.SL_RACK_POSITION.decorator="<a href=\"/resources?attribute={name}%3B{value}\">{value}</a>"
tagdecorators.IP_ADDRESS.decorator="<a href=\"ssh://{value}\">{value}</a>"
tagdecorators.IP_ADDRESS.between=", "

# Provisioner Plugin
provisioner.enabled=true
provisioner.profiles="test/resources/profiles.yaml"
provisioner.rate="1/1 minute"
provisioner.checkCommand="/Users/bmatheny/src/platform/collins/clients/apps/visioner/bin/visioner envision d2_host --config=/Users/bmatheny/src/platform/collins/clients/apps/visioner_apps/config/dev_d2.yaml --tag=<tag> --profile=<profile-id> --debug --suffix=<suffix> --notify=<notify> --noop --nocolor --app=/Users/bmatheny/src/platform/collins/clients/apps/visioner_apps"
provisioner.command="/Users/bmatheny/src/platform/collins/clients/apps/visioner/bin/visioner envision d2_host --config=/Users/bmatheny/src/platform/collins/clients/apps/visioner_apps/config/dev_d2.yaml --tag=<tag> --profile=<profile-id> --debug --suffix=<suffix> --notify=<notify> --noop --nocolor --app=/Users/bmatheny/src/platform/collins/clients/apps/visioner_apps"
timeout="10 seconds"

# Power Management Plugin
powermanagement.enabled=true
powermanagement.class="util.plugins.IpmiPowerManagement"
powermanagement.disallowStatus="" # Disallow allocated machines to be power cycled via UI
powermanagement.disallowWhenAllocated="powerOff"
powermanagement.timeout="10 seconds"
powermanagement.powerOff="ipmitool -H <host> -U <username> -P <password> -I lan -L OPERATOR chassis power off"
powermanagement.powerOn="ipmitool -H <host> -U <username> -P <password> -I lan -L OPERATOR chassis power on"
powermanagement.powerSoft="ipmitool -H <host> -U <username> -P <password> -I lan -L OPERATOR chassis power soft"
powermanagement.powerState="ipmitool -H <host> -U <username> -P <password> -I lan -L USER chassis power status"
# Reset apparently does a warn boot but I've found conflicting documentation
powermanagement.rebootHard="ipmitool -H <host> -U <username> -P <password> -I lan -L OPERATOR chassis power cycle"
powermanagement.rebootSoft="ipmitool -H <host> -U <username> -P <password> -I lan -L OPERATOR chassis power reset"
powermanagement.identify="ipmitool -H <host> -U <username> -P <password> -I lan -L OPERATOR chassis identify <interval>"
powermanagement.verify="ping -c 3 <host>"

# Advanced States
statemanager.enabled=false
statemanager.class="util.SoftLayerStateManager"

# IP Address Allocation
# Ip Address Allocation Pools
ipAddresses.pools.aaa.name="AAA"
ipAddresses.pools.aaa.network="172.16.4.0/28"
ipAddresses.pools.aaa.startAddress="172.16.4.4"
ipAddresses.pools.adminops.name="ADMIN-OPS"
ipAddresses.pools.adminops.network="172.16.56.0/24"
ipAddresses.pools.adminops.startAddress="172.16.56.5"
ipAddresses.pools.bastion.name="BASTION"
ipAddresses.pools.bastion.network="66.6.46.0/29"
ipAddresses.pools.bastion.startAddress="66.6.46.6"
ipAddresses.pools.caching.name="CACHING"
ipAddresses.pools.caching.network="172.16.52.0/24"
ipAddresses.pools.caching.startAddress="172.16.52.5"
ipAddresses.pools.database.name="DATABASE"
ipAddresses.pools.database.network="172.16.104.0/22"
ipAddresses.pools.database.startAddress="172.16.104.5"
ipAddresses.pools.dev.name="DEV"
ipAddresses.pools.dev.network="172.16.112.0/24"
ipAddresses.pools.dev.startAddress="172.16.112.5"
ipAddresses.pools.hadoop.name="HADOOP"
ipAddresses.pools.hadoop.network="172.16.92.0/23"
ipAddresses.pools.hadoop.startAddress="172.16.92.5"
ipAddresses.pools.logging.name="LOGGING"
ipAddresses.pools.logging.network="172.16.5.0/28"
ipAddresses.pools.logging.startAddress="172.16.5.5"
ipAddresses.pools.mail.name="MAIL"
ipAddresses.pools.mail.network="66.6.46.48/28"
ipAddresses.pools.mail.startAddress="66.6.46.53"
ipAddresses.pools.monitoring.name="MONITORING"
ipAddresses.pools.monitoring.network="66.6.46.16/28"
ipAddresses.pools.monitoring.startAddress="66.6.46.20"
ipAddresses.pools.public.name="PUBLIC"
ipAddresses.pools.public.network="66.6.46.128/25"
ipAddresses.pools.public.startAddress="66.6.46.132"
ipAddresses.pools.search.name="SEARCH"
ipAddresses.pools.search.network="172.16.50.0/23"
ipAddresses.pools.search.startAddress="172.16.50.10"
ipAddresses.pools.service.name="SERVICE"
ipAddresses.pools.service.network="172.16.76.0/23"
ipAddresses.pools.service.startAddress="172.16.76.5"
ipAddresses.pools.webadmin.name="WEB-ADMIN"
ipAddresses.pools.webadmin.network="172.16.71.0/28"
ipAddresses.pools.webadmin.startAddress="172.16.71.5"
ipAddresses.pools.webapi.name="WEB-API"
ipAddresses.pools.webapi.network="172.16.68.0/24"
ipAddresses.pools.webapi.startAddress="172.16.68.5"
ipAddresses.pools.webblogs.name="WEB-BLOGS"
ipAddresses.pools.webblogs.network="172.16.60.0/23"
ipAddresses.pools.webblogs.startAddress="172.16.60.5"
ipAddresses.pools.webdash.name="WEB-DASH"
ipAddresses.pools.webdash.network="172.16.96.0/22"
ipAddresses.pools.webdash.startAddress="172.16.96.5"
ipAddresses.pools.webedit.name="WEB-EDIT"
ipAddresses.pools.webedit.network="172.16.64.0/24"
ipAddresses.pools.webedit.startAddress="172.16.64.5"
ipAddresses.pools.websecure.name="WEB-SECURE"
ipAddresses.pools.websecure.network="172.16.73.0/28"
ipAddresses.pools.websecure.startAddress="172.16.73.5"

# IPMI information
ipmi.randomUsername=false
ipmi.username="root"
ipmi.passwordLength=16
ipmi.network="172.16.32.0/20"
ipmi.startAddress="172.16.32.20"

#ipmi.identify="ipmi-chassis -u <username> -h <host> -p <password> -i <interval>"
ipmi.timeout="4 seconds"

# LSHW Detection Info
lshw.flashProduct="flashmax"
lshw.flashSize="1400000000000"

authentication.cacheCredentials=false
authentication.cacheTimeout=30 seconds
authentication.permissionsFile="conf/permissions.yaml"

#authentication.type=ldap
#authentication.host=admin02.jfk01.tumblr.net
#authentication.searchbase=dc=corp,dc=tumblr,dc=net

#authentication.type="ipa"
#authentication.host="192.168.130.53"
#authentication.searchbase="cn=accounts,dc=example,dc=com"
#authentication.usersub="cn=users" # We look for users in this
#authentication.groupsub="cn=group" # We look for groups in this
#authentication.ssl=true

# Global object class
# ~~~~~
# Define the Global object class for this application.
# Default to Global in the root package.
# global=Global

# Database configuration
# ~~~~~ 
# You can declare as many datasources as you want.
# By convention, the default datasource is named `default`
#
db.collins.logStatements=false
db.collins.password=""

#db.collins.driver=org.h2.Driver
#db.collins.url="jdbc:h2:mem:play;IGNORECASE=TRUE"
#db.collins.user=sa
db.collins.driver="com.mysql.jdbc.Driver"
db.collins.url="jdbc:mysql://localhost/collins?autoReconnect=true&interactiveClient=true"
db.collins.user="root"

# Caching
cache.default=disabled
cache.class="com.tumblr.play.CachePlugin"
cache.timeout="10 minutes"

# Logger
# ~~~~~

# Root logger
logger=DEBUG

# Logger used by the framework
logger.play=DEBUG

logger.com.jolbox.bonecp=DEBUG
# Logger provided to your application
logger.application=DEBUG

#set to true to enable query logging on most model find operations
querylog.enabled = true
#prefix query logs for easy grepping
querylog.prefix = "QUERY:"
querylog.includeResults = false

#SOLR
solr.enabled = true
solr.repopulateOnStartup = false
solr.useEmbeddedServer = true
solr.externalUrl="http://localhost:8983/solr"
solr.embeddedSolrHome = "/PATH/collins/conf/solr/"
