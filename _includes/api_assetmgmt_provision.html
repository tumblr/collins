<h2>Provision an Asset</h2>

<table class="table table-condensed">
  <thead>
    <tr><td></td><td></td></tr>
  </thead>
  <tbody>
    <tr><th>Description</th><td>Provision the specified asset using the specified parameters.</td></tr>
    <tr><th>Request</th><td><code>POST /api/provision/:tag</code></td></tr>
    <tr><th>Permission</th><td>controllers.AssetManagementApi.provisionAsset</td></tr>
    <tr><td colspan="2">
      <span class="label label-info">Note</span> This API call may take a long time (depending on the configured provisioning backend).
      Client implementations should account for this with an appropriate timeout.
    </td></tr>
    <tr>
      <th>Parameters</th>
      <td>
        <table class="table table-hover table-condensed">
          <thead>
            <tr><td>Name</td><td>Type</td><td>Description</td></tr>
          </thead>
          <tbody>
            <tr>
              <th class="inlinecode">tag</th>
              <td>String</td>
              <td>Must be alphanumeric (but can include underscores and dashes)</td>
            </tr>
            <tr>
              <th class="inlinecode">profile</th>
              <td>String</td>
              <td>The provisioning profile to use. This is the <code>PROFILE</code> key from the get provisioning profiles response.</td>
            </tr>
            <tr>
              <th class="inlinecode">contact</th>
              <td>String</td>
              <td>The contact (username) for the provisioned host. This will be used later on for notification purposes.</td>
            </tr>
            <tr>
              <th class="inlinecode">suffix</th>
              <td>Option[String]</td>
              <td>If <code>SUFFIX_ALLOWED</code> is true for the specified profile, this may be supplied. This will be part of the hostname.</td>
            </tr>
            <tr>
              <th class="inlinecode">primary_role</th>
              <td>Option[String]</td>
              <td>If <code>REQUIRES_PRIMARY_ROLE</code> is true for the specified profile, and <code>PRIMARY_ROLE</code> is null, this value must be supplied.</td>
            </tr>
            <tr>
              <th class="inlinecode">secondary_role</th>
              <td>Option[String]</td>
              <td>If <code>REQUIRES_SECONDARY_ROLE</code> is true for the specified profile, and <code>SECONDARY_ROLE</code> is null, this value must be supplied.</td>
            </tr>
            <tr>
              <th class="inlinecode">pool</th>
              <td>String</td>
              <td>If <code>REQUIRES_POOL</code> is true for the specified profile, and <code>POOL</code> is null, this value must be supplied.</td>
            </tr>
            <tr>
              <th class="inlinecode">activate</th>
              <td>Option[Boolean]</td>
              <td>If the activation plugin is enabled and appropriate for the asset, this value must be true. This is primarily used in on-demand environments where you pull assets from a spare or on-demand pool.</td>
            </tr>
          </tbody>
        </table>
      </td>
    </tr>
    <tr>
      <th>Response Codes</th>
      <td>
        <table class="table-hover table-condensed">
          <thead>
            <tr><td>Code</td><td>Reason</td></tr>
          </thead>
          <tbody>
            <tr>
              <th class="inlinecode">200</th>
              <td>Asset has successfully started the provisioning process</td>
            </tr>
            <tr>
              <th class="inlinecode">403</th>
              <td>
                Forbidden by configuration
                <ul>
                  <li><code>features.ignoreDangerousCommands</code> - forbids managing power state</li>
                  <li><code>provisioner.allowedStatus</code> - forbids asset with this status from being provisioned</li>
                </ul>
              </td>
            </tr>
            <tr>
              <th class="inlinecode">404</th>
              <td>Asset not found</td>
            </tr>
            <tr>
              <th class="inlinecode">429</th>
              <td>You have exceeded the configured provisioning rate limit</td>
            </tr>
            <tr>
              <th class="inlinecode">501</th>
              <td>Plugin not enabled</td>
            </tr>
          </tbody>
        </table>
      </td>
    </tr>
  </tbody>
</table>

<div class="example collins-shell">
collins-shell provision host tumblrtag1 devnode blake --suffix=blake
</div>

<div class="example curl">
curl -v -u blake:admin:first --basic \<br>
<span class="tab4"></span>-d profile=devnode \<br>
<span class="tab4"></span>-d contact=blake \<br>
<span class="tab4"></span>-d suffix=blake \<br>
<span class="tab4"></span>http://localhost:9000/api/provision/tumblrtag1
</div>
<div class="accordion" id="assetmgmt-provision-response">
  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#assetmgmt-provision-response" href="#assetmgmt-provision-json-response">JSON Response</a>
    </div>
    <div id="assetmgmt-provision-json-response" class="accordion-body collapse">
      <div class="accordion-inner">
        <pre>{
  "status": "success:ok",
  "data": {
    "SUCCESS": true
  }
}</pre>
      </div>
    </div>
  </div>
</div> <!-- accordion -->
